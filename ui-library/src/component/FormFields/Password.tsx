import { PasswordProps } from '../../interfaces/formFields';
import ErrorValidationMessage from '../ErrorValidation';
import { useState } from 'react';
import { Controller } from 'react-hook-form';

export const Password = (inputProps: Readonly<PasswordProps>) => {
  const {
    label,
    name,
    control,
    error,
    sizeMax = 0,
    sizeMin = 0,
    matchField = '',
    required = false,
    className = '',
    placeholder = '',
    onChange,
  } = inputProps;

  const [visible, setVisible] = useState(false);

  const handleMouseDown = () => setVisible(true);
  const handleMouseUp = () => setVisible(false);
  const handleMouseLeave = () => setVisible(false);

  return (
    <div className={`form-control`}>
      <Controller
        name={name}
        control={control}
        render={({ field }) => (
          <>
            <input
              className={`${className} ${error ? 'field-error' : ''}`}
              type={visible ? 'text' : 'password'}
              {...field}
              id={name}
              autoComplete="off"
              placeholder={placeholder}
              onFocus={() => {}}
              onBlur={() => {}}
              onChange={(event) => {
                field.onChange(event.target.value);
                onChange?.(event.target.value);
              }}
              onPaste={(e) => {
                e.preventDefault();
              }}
            />
            {label && (
              <label className={`input-label`} htmlFor={name}>
                {label}
                {required && <span>*</span>}
              </label>
            )}
            <button
              className="eye-icon"
              type="button"
              onMouseDown={handleMouseDown}
              onMouseUp={handleMouseUp}
              onMouseLeave={handleMouseLeave}
              onTouchStart={handleMouseDown}
              onTouchEnd={handleMouseUp}
              onTouchCancel={handleMouseUp}
            >
              {visible ? (
                <svg
                  width="22"
                  height="17"
                  viewBox="0 0 22 17"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    d="M11.1887 4.09241C9.0508 4.09241 7.30902 5.89227 7.30902 8.10708C7.30902 10.3219 9.04834 12.1217 11.1887 12.1217C13.3265 12.1217 15.0683 10.3219 15.0683 8.10708C15.0683 5.89227 13.3265 4.09241 11.1887 4.09241ZM11.1887 10.1335C10.1087 10.1335 9.22793 9.22467 9.22793 8.10453C9.22793 6.9844 10.1062 6.07556 11.1887 6.07556C12.2711 6.07556 13.1494 6.9844 13.1494 8.10453C13.1494 9.22467 12.2687 10.1335 11.1887 10.1335Z"
                    fill="#747474"
                  />
                  <path
                    d="M21.0098 6.38591C19.8855 4.72352 18.5496 3.19097 16.9358 2.03774C15.3219 0.884513 13.4153 0.12333 11.457 0.0622314C9.40281 0.00113308 7.36581 0.713947 5.64617 1.87991C3.92899 3.04332 2.51194 4.64206 1.35321 6.39609C1.00879 6.91797 0.674213 7.49586 0.696354 8.12721C0.713575 8.60836 0.934988 9.05387 1.17362 9.46882C2.66447 12.0655 4.95979 14.1556 7.62658 15.3801C10.2589 16.5868 13.3489 16.2482 15.8558 14.8506C18.0109 13.649 19.7502 11.7549 21.1008 9.64194C21.3936 9.1837 21.6789 8.68727 21.6962 8.13739C21.6962 8.11448 21.6962 8.09157 21.6962 8.06611C21.6888 7.45513 21.3517 6.89506 21.0098 6.38591ZM19.7182 8.16539C19.6075 8.34869 19.4943 8.52944 19.3787 8.70764C19.0712 9.17352 18.744 9.62157 18.3971 10.0543C18.3848 10.0696 18.375 10.0849 18.3627 10.1002C17.7894 10.8028 17.1572 11.452 16.4536 12.0375C16.4388 12.0502 16.4216 12.0604 16.4167 12.0655L15.7377 12.6358L14.7339 13.1958C14.1115 13.5293 13.4744 13.7788 12.8052 13.929C12.5961 13.9748 12.3894 14.013 12.1852 14.0436C11.9663 14.069 11.7498 14.0894 11.5825 14.1047C11.4054 14.1148 11.2282 14.1199 11.0511 14.1174C10.4853 14.0996 10.0326 14.041 9.58486 13.9392C9.2552 13.8628 8.93292 13.7635 8.62048 13.649C8.03743 13.43 7.46913 13.1347 6.91068 12.7732C6.67943 12.623 6.45309 12.4626 6.2366 12.2972C5.56006 11.7727 4.94749 11.1898 4.38903 10.5584C3.94621 10.0518 3.5329 9.51465 3.14666 8.94949C3.13928 8.93931 3.1319 8.92912 3.12698 8.91894C3.09008 8.86293 3.05317 8.80947 3.01627 8.75347C3.01381 8.74837 3.00889 8.74328 3.00643 8.73819C2.88588 8.55235 2.77026 8.36651 2.65463 8.17812C2.63249 8.14248 2.62757 8.06866 2.64725 8.03556C2.75796 7.85226 2.87112 7.67152 2.98675 7.49331C3.29427 7.02744 3.62147 6.57938 3.96835 6.1466C3.98065 6.13133 3.99049 6.11606 4.00279 6.10078C4.576 5.39815 5.20826 4.74898 5.91186 4.16346C5.92662 4.15073 5.94384 4.14054 5.94876 4.13545L6.63023 3.5652L7.63397 3.00259C8.25638 2.66909 8.89356 2.41961 9.56272 2.26941C9.77183 2.22358 9.97848 2.1854 10.1827 2.15485C10.4016 2.12939 10.6181 2.10902 10.7854 2.09375C10.9625 2.08357 11.1397 2.07848 11.3168 2.08102C11.8826 2.09884 12.3353 2.15739 12.783 2.25922C13.1127 2.3356 13.435 2.43234 13.7474 2.54944C14.3305 2.76838 14.8988 3.06369 15.4572 3.42518C15.6885 3.57538 15.9148 3.73577 16.1313 3.90124C16.8078 4.42312 17.4204 5.00865 17.9789 5.64C18.4217 6.1466 18.835 6.68376 19.2213 7.24892C19.2286 7.2591 19.236 7.26929 19.2409 7.27947C19.2778 7.33548 19.3147 7.38894 19.3516 7.44494C19.3541 7.45004 19.359 7.45513 19.3615 7.46022C19.482 7.64606 19.5977 7.8319 19.7133 8.02029C19.7354 8.05847 19.7403 8.1323 19.7182 8.16539Z"
                    fill="#747474"
                  />
                </svg>
              ) : (
                <svg
                  width="23"
                  height="21"
                  viewBox="0 0 23 21"
                  fill="none"
                  xmlns="http://www.w3.org/2000/svg"
                >
                  <path
                    fillRule="evenodd"
                    clipRule="evenodd"
                    d="M1.48862 0.38176C1.87915 -0.00876391 2.51231 -0.00876391 2.90283 0.38176L6.54156 4.02049C6.59986 4.0668 6.65369 4.12025 6.70168 4.18061L17.0927 14.5716C17.1605 14.6236 17.2225 14.6851 17.2767 14.7556L20.9028 18.3818C21.2934 18.7723 21.2934 19.4054 20.9028 19.796C20.5123 20.1865 19.8791 20.1865 19.4886 19.796L16.3349 16.6422C14.89 17.4877 13.1673 18.0889 11.1957 18.0889C8.33406 18.0889 6.00107 16.8241 4.27248 15.3814C2.54623 13.9407 1.36269 12.2746 0.769946 11.336C0.762112 11.3236 0.75407 11.311 0.745856 11.298C0.628223 11.1129 0.475492 10.8725 0.398295 10.5356C0.335966 10.2636 0.335987 9.91382 0.398347 9.64185C0.475595 9.30496 0.628757 9.06395 0.746698 8.87836C0.754978 8.86533 0.763084 8.85258 0.770978 8.84008C1.37337 7.88649 2.59666 6.1641 4.39107 4.69842L1.48862 1.79597C1.0981 1.40545 1.0981 0.772285 1.48862 0.38176ZM5.8136 6.12095C4.17439 7.41508 3.02935 9.00989 2.46186 9.90822C2.42636 9.96441 2.40148 10.0039 2.38068 10.0381C2.3668 10.0609 2.35766 10.0767 2.35156 10.0877L2.35156 10.0888L2.35156 10.0901C2.35758 10.1009 2.36658 10.1164 2.38021 10.1389C2.40088 10.1729 2.4256 10.2121 2.46095 10.2681C2.99361 11.1115 4.04771 12.5888 5.554 13.846C7.05794 15.1012 8.9524 16.0889 11.1957 16.0889C12.5487 16.0889 13.7731 15.7303 14.8627 15.1701L13.2275 13.5349C12.6321 13.8866 11.9371 14.0889 11.1957 14.0889C8.98659 14.0889 7.19573 12.298 7.19573 10.0889C7.19573 9.34748 7.39802 8.65249 7.74969 8.05705L5.8136 6.12095ZM9.26331 9.57066C9.21919 9.73585 9.19573 9.90952 9.19573 10.0889C9.19573 11.1934 10.0912 12.0889 11.1957 12.0889C11.3751 12.0889 11.5487 12.0654 11.7139 12.0213L9.26331 9.57066ZM11.1957 4.08887C10.8139 4.08887 10.4435 4.11736 10.0845 4.17043C9.53817 4.25121 9.02979 3.87379 8.94901 3.32745C8.86823 2.7811 9.24565 2.27272 9.792 2.19194C10.2458 2.12484 10.714 2.08887 11.1957 2.08887C14.0574 2.08887 16.3904 3.35359 18.119 4.7963C19.8452 6.23705 21.0288 7.90315 21.6215 8.84172C21.6293 8.85412 21.6374 8.86678 21.6456 8.87971C21.7632 9.06488 21.916 9.30531 21.9932 9.64218C22.0555 9.91415 22.0555 10.264 21.9931 10.536C21.9158 10.8729 21.7624 11.1143 21.6443 11.3001C21.636 11.3132 21.6278 11.326 21.6199 11.3386C21.3016 11.8424 20.8185 12.5469 20.1785 13.3113C19.824 13.7348 19.1933 13.7906 18.7698 13.436C18.3464 13.0815 18.2905 12.4508 18.6451 12.0273C19.2164 11.345 19.6478 10.7156 19.9291 10.2703C19.9647 10.214 19.9896 10.1744 20.0105 10.1401C20.0245 10.117 20.0338 10.1011 20.0399 10.09L20.0399 10.0889L20.0399 10.0877C20.0339 10.0769 20.0249 10.0613 20.0112 10.0389C19.9906 10.0048 19.9659 9.96563 19.9305 9.90966C19.3979 9.06624 18.3437 7.58894 16.8375 6.33177C15.3335 5.07657 13.4391 4.08887 11.1957 4.08887Z"
                    fill="#747474"
                  />
                </svg>
              )}
            </button>
          </>
        )}
      />

      {error && (
        <ErrorValidationMessage
          errors={error}
          name={label?.toLowerCase()}
          sizeMax={sizeMax}
          sizeMin={sizeMin}
          matchField={matchField}
        />
      )}
    </div>
  );
};
