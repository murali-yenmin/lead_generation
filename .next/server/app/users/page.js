(()=>{var e={};e.id=5009,e.ids=[5009],e.modules={1895:(e,s,t)=>{Promise.resolve().then(t.bind(t,14103))},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14103:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>a});let a=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\murali\\\\AutoPost-n8n-Lead-Generation-tool\\\\src\\\\app\\\\users\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\murali\\AutoPost-n8n-Lead-Generation-tool\\src\\app\\users\\page.tsx","default")},15807:(e,s,t)=>{Promise.resolve().then(t.bind(t,88855))},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},66565:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>i.a,__next_app__:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>c});var a=t(65239),r=t(48088),n=t(88170),i=t.n(n),l=t(30893),o={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(o[e]=()=>l[e]);t.d(s,o);let c={children:["",{children:["users",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,14103)),"D:\\murali\\AutoPost-n8n-Lead-Generation-tool\\src\\app\\users\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(t.bind(t,94431)),"D:\\murali\\AutoPost-n8n-Lead-Generation-tool\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(t.bind(t,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,d=["D:\\murali\\AutoPost-n8n-Lead-Generation-tool\\src\\app\\users\\page.tsx"],u={require:t,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:r.RouteKind.APP_PAGE,page:"/users/page",pathname:"/users",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},74075:e=>{"use strict";e.exports=require("zlib")},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},83997:e=>{"use strict";e.exports=require("tty")},88855:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>L});var a=t(60687),r=t(43210),n=t(97476),i=t(44493),l=t(96834),o=t(17612),c=t(11516),d=t(81740),u=t(85309),m=t(93090),x=t(69795),h=t(76311);let p=(0,t(82614).A)("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);var j=t(48206),g=t(14975),v=t(32584),b=t(43010),f=t(54864),y=t(98949),A=t(62622),C=t(99825),N=t(27605),w=t(63442),P=t(43214);t(45314);var k=t(29523),_=t(63503),q=t(71669),z=t(89667),I=t(15079),$=t(29867),U=t(35265);let M=P.Ik({name:P.Yj().min(2,{message:"Name must be at least 2 characters."}),email:P.Yj().email({message:"Please enter a valid email address."}),organizationId:P.Yj().min(1,{message:"Please select an organization."}),roleId:P.Yj().min(1,{message:"Please select a role."}),teamId:P.Yj().optional()});function S({open:e,onOpenChange:s,onUserAdded:t,currentUser:n}){let i=(0,f.wA)(),{toast:l}=(0,$.dj)(),{organizations:o,teams:d,status:u}=(0,f.d4)(e=>e.users),{roles:m}=(0,f.d4)(e=>e.settings),[x,h]=(0,r.useState)(""),p=(0,N.mN)({resolver:(0,w.u)(M),defaultValues:{name:"",email:"",organizationId:"",roleId:"",teamId:""}}),j=n?.roleName==="Super Admin",g=m.find(e=>e.name===n?.roleName),v=g?.level||0,b=m?m.filter(e=>e.level<v):[],y=p.watch("organizationId"),A=async()=>{if(x.trim()&&y)try{let e=await i((0,C.gj)({organizationId:y,name:x})).unwrap();l({title:"Team Created",description:`Successfully created the "${x}" team.`,variant:"success"}),p.setValue("teamId",e._id),h("")}catch(e){l({title:"Failed to Create Team",description:e,variant:"destructive"})}},P=async e=>{try{await i((0,C.nu)(e)).unwrap(),l({title:"User Created",description:`An invitation has been sent to ${e.email}.`,variant:"success"}),t()}catch(e){l({title:"Failed to Create User",description:e,variant:"destructive"})}};return(0,a.jsx)(_.lG,{open:e,onOpenChange:s,children:(0,a.jsxs)(_.Cf,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(_.c7,{children:[(0,a.jsx)(_.L3,{children:"Add New User"}),(0,a.jsx)(_.rr,{children:"Enter the details below to invite a new user to the platform."})]}),(0,a.jsx)(q.lV,{...p,children:(0,a.jsxs)("form",{onSubmit:p.handleSubmit(P),className:"space-y-4 py-4",children:[(0,a.jsx)(q.zB,{control:p.control,name:"name",render:({field:e})=>(0,a.jsxs)(q.eI,{children:[(0,a.jsx)(q.lR,{children:"Full Name"}),(0,a.jsx)(q.MJ,{children:(0,a.jsx)(z.p,{placeholder:"John Doe",...e})}),(0,a.jsx)(q.C5,{})]})}),(0,a.jsx)(q.zB,{control:p.control,name:"email",render:({field:e})=>(0,a.jsxs)(q.eI,{children:[(0,a.jsx)(q.lR,{children:"Email Address"}),(0,a.jsx)(q.MJ,{children:(0,a.jsx)(z.p,{placeholder:"john.doe@example.com",...e})}),(0,a.jsx)(q.C5,{})]})}),(0,a.jsx)(q.zB,{control:p.control,name:"organizationId",render:({field:e})=>(0,a.jsxs)(q.eI,{children:[(0,a.jsx)(q.lR,{children:"Organization"}),(0,a.jsxs)(I.l6,{onValueChange:e.onChange,value:e.value,disabled:!j,children:[(0,a.jsx)(q.MJ,{children:(0,a.jsx)(I.bq,{children:(0,a.jsx)(I.yv,{placeholder:"Select an organization"})})}),(0,a.jsx)(I.gC,{children:o.map(e=>(0,a.jsx)(I.eb,{value:e._id,children:e.name},e._id))})]}),(0,a.jsx)(q.C5,{})]})}),(0,a.jsx)(q.zB,{control:p.control,name:"roleId",render:({field:e})=>(0,a.jsxs)(q.eI,{children:[(0,a.jsx)(q.lR,{children:"Role"}),(0,a.jsxs)(I.l6,{onValueChange:e.onChange,value:e.value,children:[(0,a.jsx)(q.MJ,{children:(0,a.jsx)(I.bq,{children:(0,a.jsx)(I.yv,{placeholder:"Select a role"})})}),(0,a.jsx)(I.gC,{children:b.map(e=>(0,a.jsx)(I.eb,{value:e._id,children:e.name},e._id))})]}),(0,a.jsx)(q.C5,{})]})}),(0,a.jsx)(q.zB,{control:p.control,name:"teamId",render:({field:e})=>(0,a.jsxs)(q.eI,{children:[(0,a.jsx)(q.lR,{children:"Team (Optional)"}),(0,a.jsxs)(I.l6,{onValueChange:s=>e.onChange("no-team"===s?"":s),value:e.value||"no-team",disabled:!y,children:[(0,a.jsx)(q.MJ,{children:(0,a.jsx)(I.bq,{children:(0,a.jsx)(I.yv,{placeholder:"Select a team"})})}),(0,a.jsxs)(I.gC,{children:[(0,a.jsx)(I.eb,{value:"no-team",children:"No Team"}),d.map(e=>(0,a.jsx)(I.eb,{value:e._id,children:e.name},e._id)),(0,a.jsx)("div",{className:"p-2 mt-2 border-t",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(z.p,{placeholder:"New team name...",value:x,onChange:e=>h(e.target.value),className:"flex-1"}),(0,a.jsxs)(k.$,{type:"button",size:"sm",onClick:A,disabled:!x.trim(),children:[(0,a.jsx)(U.A,{className:"mr-2 size-4"})," Add"]})]})})]})]}),(0,a.jsx)(q.C5,{})]})}),(0,a.jsxs)(_.Es,{children:[(0,a.jsx)(k.$,{type:"button",variant:"ghost",onClick:()=>s(!1),children:"Cancel"}),(0,a.jsxs)(k.$,{type:"submit",disabled:"loading"===u,children:["loading"===u&&(0,a.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Invite User"]})]})]})})]})})}var R=t(21342),G=t(55925),E=t(16189);let D=e=>e.split(" ").map(e=>e[0]).join("").toUpperCase();function L(){let e=(0,f.wA)(),s=(0,E.useRouter)(),{toast:t}=(0,$.dj)(),{users:N,totalUsers:w,page:P,limit:_,searchTerm:q,roleFilter:z,statusFilter:I,isLoading:U,updatingUserId:M,error:L}=(0,f.d4)(e=>e.users),{user:F,token:B}=(0,f.d4)(e=>e.auth),{roles:O}=(0,f.d4)(e=>e.settings),[T,V]=(0,r.useState)(!1),[J,K]=(0,r.useState)(null),[Y]=(0,n.d7)(q,500),Z=Math.ceil(w/_),H=(0,r.useMemo)(()=>O.map(e=>e.name),[O]),Q=async()=>{if(!J)return;let{user:s,action:a}=J,r="activate"===a?"active":"deactivated",n=await e((0,C.pU)({userId:s._id,status:r}));if(C.pU.fulfilled.match(n)){let e=a.charAt(0).toUpperCase()+a.slice(1);t({title:`User ${e}d`,description:`${s.name}'s account has been successfully ${e.toLowerCase()}d.`,variant:"success"})}else t({title:"Action Failed",description:n.payload||`Failed to ${a} ${s.name}. Please try again.`,variant:"destructive"});K(null)},W=e=>{s.push(`/users/${e._id}`)},X=(0,r.useMemo)(()=>[{accessorKey:"name",header:"User",cell:({row:e})=>{let s=e.original,t=s.image&&s.image[0]?s.image[0].url:null;return(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(v.eu,{children:[t&&(0,a.jsx)(v.BK,{src:t}),(0,a.jsx)(v.q5,{children:D(s.name)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium",children:s.name}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:s.email})]})]})}},{accessorKey:"organizationName",header:"Organization",cell:({row:e})=>(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(o.A,{className:"size-4 text-muted-foreground"}),(0,a.jsx)("span",{children:e.original.organizationName||"N/A"})]})},{accessorKey:"roleName",header:"Role",cell:({row:e})=>(0,a.jsx)(l.E,{variant:"outline",children:e.original.roleName||"N/A"})},{accessorKey:"status",header:"Status",cell:({row:e})=>{let s=e.original;if(M===s._id)return(0,a.jsxs)(l.E,{variant:"outline",className:"animate-pulse",children:[(0,a.jsx)(c.A,{className:"mr-1.5 animate-spin"}),"Updating..."]});let t={active:{variant:"secondary",icon:d.A,label:"Active",className:"bg-green-100 text-green-800 dark:bg-green-900/50 dark:text-green-300"},pending:{variant:"default",icon:u.A,label:"Pending",className:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300"},deactivated:{variant:"destructive",icon:m.A,label:"Deactivated",className:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"}},{variant:r,icon:n,label:i,className:o}=t[s.status]||t.pending;return(0,a.jsxs)(l.E,{variant:r,className:o,children:[(0,a.jsx)(n,{className:"mr-1.5"}),i]})}},{accessorKey:"createdAt",header:"Date Joined",cell:({row:e})=>(0,b.GP)(new Date(e.original.createdAt),"PPP")},{id:"actions",header:"",cell:({row:e})=>{let s=e.original,t="Super Admin"===s.roleName,r="active"===s.status,n=M===s._id;return(0,a.jsxs)(R.rI,{children:[(0,a.jsx)(R.ty,{asChild:!0,children:(0,a.jsxs)(k.$,{variant:"ghost",className:"h-8 w-8 p-0",disabled:n,children:[(0,a.jsx)("span",{className:"sr-only",children:"Open menu"}),(0,a.jsx)(x.A,{className:"h-4 w-4"})]})}),(0,a.jsxs)(R.SQ,{align:"end",children:[(0,a.jsx)(R.lp,{children:"Actions"}),(0,a.jsxs)(R._2,{onClick:()=>W(s),children:[(0,a.jsx)(h.A,{className:"mr-2 h-4 w-4"}),"View"]}),!t&&(0,a.jsx)(R.mB,{}),!t&&(0,a.jsx)(a.Fragment,{children:r?(0,a.jsxs)(R._2,{onClick:()=>K({user:s,action:"deactivate"}),className:"text-destructive focus:bg-destructive/10 focus:text-destructive",children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Deactivate Account"]}):(0,a.jsxs)(R._2,{onClick:()=>K({user:s,action:"activate"}),className:"text-green-600 focus:bg-green-500/10 focus:text-green-700 dark:text-green-400 dark:focus:text-green-400",children:[(0,a.jsx)(p,{className:"mr-2 h-4 w-4"}),"Activate Account"]})})]})]})}}],[H,s,M]),ee=(0,r.useMemo)(()=>[{value:"all",label:"All Roles"},...H.map(e=>({value:e,label:e}))],[H]),es=(0,r.useMemo)(()=>[{value:"all",label:"All Statuses"},{value:"active",label:"Active"},{value:"pending",label:"Pending"},{value:"deactivated",label:"Deactivated"}],[]),et=J?.action||"deactivate",ea=et.charAt(0).toUpperCase()+et.slice(1),er=`${ea} Account?`,en=`This will ${et} the account for ${J?.user.name} (${J?.user.email}). They will ${"deactivate"===et?"lose all":"regain"} access to the platform. Are you sure?`;return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("main",{className:"flex flex-1 flex-col gap-6 p-4 sm:px-6 md:gap-8 md:p-8",children:(0,a.jsxs)(i.Zp,{children:[(0,a.jsxs)(i.aR,{children:[(0,a.jsxs)(i.ZB,{className:"flex items-center gap-2 text-2xl font-headline",children:[(0,a.jsx)(j.A,{className:"size-8"}),"User Management"]}),(0,a.jsx)(i.BT,{children:"View, search, and manage all users in your organization."})]}),(0,a.jsx)(i.Wu,{children:(0,a.jsx)(y.b,{columns:X,data:N,isLoading:U,error:L,pageCount:Z,currentPage:P,onPageChange:s=>e((0,C.Ir)(s)),currentLimit:_,onLimitChange:s=>e((0,C.aF)(s)),children:(0,a.jsx)(A.w,{searchTerm:q,onSearchChange:s=>e((0,C.NM)(s)),filters:[{value:z,onChange:s=>e((0,C.Hd)(s)),placeholder:"Filter by role",options:ee},{value:I,onChange:s=>e((0,C.V5)(s)),placeholder:"Filter by status",options:es}],actions:[{label:"Add user",onClick:()=>V(!0)}]})})})]})}),(0,a.jsx)(S,{open:T,onOpenChange:V,onUserAdded:()=>{V(!1),e((0,C.hU)())},currentUser:F}),(0,a.jsx)(G.Lt,{open:!!J,onOpenChange:e=>!e&&K(null),children:(0,a.jsxs)(G.EO,{children:[(0,a.jsxs)(G.wd,{children:[(0,a.jsxs)(G.r7,{className:"flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"deactivate"===et?"text-destructive":"text-green-500"}),er]}),(0,a.jsx)(G.$v,{children:en})]}),(0,a.jsxs)(G.ck,{children:[(0,a.jsx)(G.Zr,{children:"Cancel"}),(0,a.jsx)(G.Rx,{onClick:Q,className:"deactivate"===et?"bg-destructive hover:bg-destructive/90 text-destructive-foreground":"bg-green-600 hover:bg-green-600/90 text-white",children:ea})]})]})})]})}},91645:e=>{"use strict";e.exports=require("net")},94735:e=>{"use strict";e.exports=require("events")}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[4447,6724,5744,1658,4136,676,9080,5037,348,4220],()=>t(66565));module.exports=a})();